{% extends "base.html" %}


{% block content %}



<div class="container-fluid bg-3">

  <div class="row">

    <div class="col-lg-8">
      <h2>Autovermietungen in GÃ¶ttingen:</h2>
    </div>

    <div class="col-lg-4">
    </div>



  </div>

    <div class="row">

      <div class="col-lg-8">

        <div id="map"></div>

          <script>

            var map, heatmap;

            function initMap() {
              map = new google.maps.Map(document.getElementById('map'), {
                zoom: 12,
                center: {lat: 51.533767,lng: 9.934980},
                mapTypeId: 'satellite'
              });

            //set heatmap

              heatmap = new google.maps.visualization.HeatmapLayer({
                data: getPoints(),
                map: map
              });

              getMarker(map);

              // set Marker 



            }

            function toggleHeatmap() {
              heatmap.setMap(heatmap.getMap() ? null : map);
            }

            function changeGradient() {
              var gradient = [
                'rgba(0, 255, 255, 0)',
                'rgba(0, 255, 255, 1)',
                'rgba(0, 191, 255, 1)',
                'rgba(0, 127, 255, 1)',
                'rgba(0, 63, 255, 1)',
                'rgba(0, 0, 255, 1)',
                'rgba(0, 0, 223, 1)',
                'rgba(0, 0, 191, 1)',
                'rgba(0, 0, 159, 1)',
                'rgba(0, 0, 127, 1)',
                'rgba(63, 0, 91, 1)',
                'rgba(127, 0, 63, 1)',
                'rgba(191, 0, 31, 1)',
                'rgba(255, 0, 0, 1)'
              ]
              heatmap.set('gradient', heatmap.get('gradient') ? null : gradient);
            }

            // Heatmap data: 500 Points
            function getPoints() {
              
            carstations = JSON.parse("{{ carstations|escapejs }}");
           
            var stations = [];
            carstations.forEach(function(station){
              stations.push({location: new google.maps.LatLng(station[0],station[1]), weight:station[2]});   
              });

            console.log(stations);
            return stations; 
          }

          function getMarker(map) {
              

            carstations = JSON.parse("{{ carstations|escapejs }}");
            var mapmarker = [];

            console.log(carstations);

            carstations.forEach(function(station){
              var pos = {lat: station[0], lng: station[1]};
              var marker = new google.maps.Marker({
                position: pos,
                map: map,
                label: station[4],
                title: station[3]
              });

            marker.setMap(map)
            });
          }


      

             
          </script>
          <script async defer
              src="{{key}}">
          </script>

          </div>

      <div class="col-lg-4">

        <div class="list-group" height=400px>
          {% for car in carstations2 %}

            <a href="#" class="list-group-item list-group-item-action flex-column align-items-start">
            <div class="d-flex w-100 justify-content-between">
            <h3 class="mb-1"> Name: {{ car.name }}</h5>
            <small> Adresse: {{ car.address}}</small>
            <p class="mb-1"> Buchungen: {{ car.bookings }}</small>
            </div>
            </a>

          {% endfor %}

    </div>




      </div>

   </div>

</div>




{% endblock %}